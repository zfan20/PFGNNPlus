Part of the code is borrowed from https://github.com/CharlieDinh/pFedMe.
